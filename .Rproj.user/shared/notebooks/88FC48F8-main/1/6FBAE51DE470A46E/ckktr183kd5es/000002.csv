"0","df_counties <- df_clean %>%"
"0","  mutate(COUNTYNAME = tolower(COUNTYNAME)) %>%"
"0","  mutate(COUNTYNAME = trimws(COUNTYNAME, which = ""both"")) %>%"
"0","  group_by(STATENAME, COUNTYNAME) %>%"
"0","  summarise(STATENAME = tolower(STATENAME), TOTAL = n())"
"1","`summarise()` has grouped output by 'STATENAME', 'COUNTYNAME'. You can override using the `.groups` argument.
"
"0","countyTotals <- function(counties) {"
"0","  totals <- c()"
"0","  for(i in 1:nrow(counties)) {"
"0","    statename <- counties[i, 'region']"
"0","    countyname <- counties[i, 'subregion']"
"0",""
"0","    if (countyname %in% df_counties$COUNTYNAME) {"
"0","      totals <- append(totals, "
"0","                       df_counties[which(df_counties$COUNTYNAME == countyname & df_counties$STATENAME == statename), 'TOTAL'][[1]][1])"
"0","    }"
"0","    else {"
"0","      totals <- append(totals, 0)"
"0","      next"
"0","    }"
"0","  }"
"0","  return(totals)"
"0","}"
"0",""
"0","county_totals <- countyTotals(us_counties_t)"
"0",""
